// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Athlete {
  id             String        @id @default(uuid()) @db.Uuid
  firstname      String        @db.VarChar(255)
  lastname       String        @db.VarChar(255)
  birthdate      DateTime
  nationality    String        @default("M") @db.VarChar(255)
  gender         String        @default("M") @db.Char(1)
  dossard        Int?
  liveId         String
  organization   Organization? @relation(fields: [organizationId], references: [id])
  organizationId String?       @db.Uuid

  createdAt DateTime? @default(now())
  updatedAt DateTime? @updatedAt

  @@index([liveId])
}

model Organization {
  id         String @id @default(uuid()) @db.Uuid
  fed_number Int
  type       String @db.VarChar(255)
  name       String @db.VarChar(255)
  abbr       String @db.VarChar(255)
  alias      String @db.VarChar(255)
  location   String @db.VarChar(255)
  federation String @db.VarChar(255)

  contact_person String?   @db.VarChar(255)
  contact_email  String?   @db.VarChar(255)
  contact_phone1 String?   @db.VarChar(255)
  contact_phone2 String?   @db.VarChar(255)
  Athlete        Athlete[]

  createdAt DateTime? @default(now())
  updatedAt DateTime? @updatedAt
  Event     Event[]
}

model Category {
  id             String   @id @default(uuid()) @db.Uuid
  federation     String   @db.VarChar(255)
  name           String   @db.VarChar(255)
  abbr           String   @db.VarChar(255)
  ageMin         Int
  ageMax         Int
  changeMin      String   @db.VarChar(255)
  changeMax      String   @db.VarChar(255)
  gender         String   @default("M") @db.Char(1)
  nationalCode   String   @db.Char(1)
  sortOrder      Int
  categoryId     Int
  fedinsidelabel String   @db.VarChar(255)
  Result         Result[]
}

model Director {
  id                String  @id @default(uuid()) @db.Uuid
  directorFirstName String? @db.VarChar(255)
  directorLastName  String? @db.VarChar(255)
  directorEmail     String? @db.VarChar(255)
  Event             Event[]
}

model Secretary {
  id                 String  @id @default(uuid()) @db.Uuid
  secretaryFirstName String? @db.VarChar(255)
  secretaryLastName  String? @db.VarChar(255)
  secretaryEmail     String? @db.VarChar(255)
  Event              Event[]
}

model ResultPerformance {
  id            String          @id @default(uuid()) @db.Uuid
  place         Int?
  time          DateTime?       @db.Time
  distance      Decimal?
  wind          Decimal?
  ResultDetails ResultDetails[]
}

model ResultDetails {
  id                  String            @id @default(uuid()) @db.Uuid
  resultPerformanceId String            @db.Uuid
  results             ResultPerformance @relation(fields: [resultPerformanceId], references: [id])
  Result              Result[]
}

model Result {
  id          String   @id @default(uuid()) @db.Uuid
  eventNumber String   @db.VarChar(255)
  name        String   @db.VarChar(255)
  abbr        String   @db.VarChar(255)
  type        String   @db.VarChar(255)
  date        DateTime
  validation  String   @db.VarChar(255)
  xmlId       Int?
  round       Json
  heat        Json

  resultDetailsId String        @db.Uuid
  result          ResultDetails @relation(fields: [resultDetailsId], references: [id])
  eventCategory   Json
  athleteCategory Json

  eventId String @db.Uuid
  event   Event  @relation(fields: [eventId], references: [id])

  eventTypeId String
  eventType   EventType @relation(fields: [eventTypeId], references: [id])

  categoryId String
  category   Category @relation(fields: [categoryId], references: [id])
}

model Event {
  id           String    @id @default(uuid()) @db.Uuid
  eventNumber  String    @db.VarChar(255)
  name         String    @db.VarChar(255)
  date_start   DateTime
  date_end     DateTime
  start_time   DateTime?
  championship Boolean   @default(false)
  season       String?   @db.VarChar(255)
  facility     String?   @db.VarChar(255)

  directorId  String?   @db.Uuid
  responsible Director? @relation(fields: [directorId], references: [id])

  secretaryId  String?    @db.Uuid
  responsible2 Secretary? @relation(fields: [secretaryId], references: [id])

  type   String? @db.VarChar(255)
  chrono String  @default("unkown") @db.VarChar(255)

  organizationId String?       @db.Uuid
  organization   Organization? @relation(fields: [organizationId], references: [id])
  Result         Result[]
}

model EventType {
  id               String  @id @default(uuid()) @db.Uuid
  venue            String  @db.Char(1)
  distance         Int
  wind_mode        String  @db.VarChar(255)
  wind_time        String  @db.VarChar(255)
  precision        Int
  handtime_diff    String  @db.VarChar(255)
  nb_athletes      Int
  implement        String  @db.VarChar(255)
  hurdles_nb       Int
  hurdles_first    Decimal
  hurdles_interval Decimal
  hurdles_last     Decimal
  abbr             String  @db.VarChar(255)
  name_fr          String  @db.VarChar(255)
  name_nl          String  @db.VarChar(255)
  name_de          String  @db.VarChar(255)
  name_en          String  @db.VarChar(255)
  low2high         Int
  national_code    String  @db.VarChar(255)
  sort_order       Int
  type_id          String  @db.VarChar(255)
  result_type      String  @db.VarChar(255)
  discipline_group String  @db.VarChar(255)

  Result Result[]
}
